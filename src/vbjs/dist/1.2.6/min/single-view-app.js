define(["sys/app"],e=>t=>{let n;if(e.queryString=document.location.search?(e=>e.slice(e.indexOf("?")+1).match(/[\w\d%\-!.~'()\*]+=[\w\d%\-!.~'()\*]+/g).map(e=>e.split("=").map(decodeURIComponent)).reduce((e,[t,n])=>Object.assign(e,{[t]:n}),{}))(document.location.search):{},e.config.view)if(!e.config.view.startsWith("document!")||t&&"app"!==t)n=document.getElementById(t).html("");else{let i=()=>(t=e.config.view.replace("document!",""),(document.getElementById(t)||document.getElementsByName(t)).parentElement);t?(n=document.getElementById(t))||(t=e.config.view.replace("document!",""),n=i()):n=i()}else{let t=document.getElementsByTagName("template");if(!t.length)throw new Error("Couldn't find any appropriate template to initialize application. There are no template tags and attribute data-view-module is not set!");{let i=t[t.length-1];i.id=_app.config.name,e.config.view="document!"+_app.config.name,n=i.parentElement}}return e.render(e.config.view,n,Object.assign({},e.queryString))});