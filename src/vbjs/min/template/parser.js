define(["sys/template/helpers","sys/template/import","sys/template/tags"],(e,t,n)=>{const r=requirejs.s.contexts._.config.__appObjName,a=window[r];a.template=((e,...t)=>{let n=[];for(let e=0,r=t.length;e<r;e++){let r=t[e];if("function"==typeof r){let n=r();r=void 0===n||"function"==typeof n?"":n,t[e]=r}r instanceof Promise&&n.push({index:e,sub:r}),void 0===r&&(t[e]="")}return n.length?(async()=>{for(let e=0,r=n.length;e<r;e++){let r=n[e],a=await r.sub;if("function"==typeof a){let e=a();e instanceof Promise&&(e=await e),a=void 0===e||"function"==typeof e?"":e}t[r.index]=void 0===a?"":a}return String.raw(e,...t)})():String.raw(e,...t)}),a.composite=((e,...t)=>t);const i=(t,n,r)=>((t=t||{}).template||(t.template=e),r&&(t.template=Object.assign(t.template,r)),t.template.name=n,t.___rendered=(e=>!t.template.rendered||t.template.rendered(e)),t),s=(e,t,a,s)=>new Function("return "+r+".template`"+n.parse(e)+"`;").call(i(t,s,a));return a.parse=(async(e,n,r,a)=>{let i;if("string"==typeof e)i=e;else{let t=(i=e.toString()).indexOf("`",0);if(-1===t)throw new Error("Invalid template");i=i.substring(t+1,i.lastIndexOf("`"))}return await t.parseImportsAsync(i),await s(i,n,r,a)}),{parseTemplate:s,parseComposite:(e,t,a,s)=>new Function("return "+r+".composite`"+n.parse(e)+"`;").call(i(t,s,a))}});